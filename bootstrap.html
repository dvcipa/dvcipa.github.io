<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DVC IPA - HACK GAME IOS©</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

    <style>
        body {
            background-color: #f8f9fa;
        }
        .post-card {
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .post-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        .post-img {
            width: 100px;
            height: 100px;
            object-fit: cover;
        }
        .footer {
            padding: 1.5rem 0;
        }
        .pagination-container {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }
        /* THAY ĐỔI 1: Tăng giới hạn dòng và điều chỉnh style cho phần chức năng */
        .features-text {
            display: -webkit-box;
            -webkit-line-clamp: 3; /* Tăng giới hạn hiển thị lên 3 dòng */
            -webkit-box-orient: vertical;
            overflow: hidden;
            text-overflow: ellipsis;
            line-height: 1.4; /* Giãn cách dòng cho dễ đọc */
        }
    </style>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">
        <div class="container">
            <a class="navbar-brand d-flex align-items-center" href="index.html">
                <img src="DVC.png" alt="Logo" style="height: 40px;" class="me-2">
                <b>DVC IPA</b>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="index.html">Trang Chủ</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="http://key.chungchidvc.com">Mua Key</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="http://chungchidvc.com">Chứng Chỉ</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="modal fade" id="notificationModal" tabindex="-1" aria-labelledby="notificationModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title text-danger" id="notificationModalLabel"><i class="bi bi-exclamation-triangle-fill"></i> Thông báo quan trọng!!!</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p><b>Telegram đã bị chặn, anh em khắc phục tạm thời bằng cách lên Appstore tải app <span class="text-danger fst-italic">1.1.1.1</span> về sử dụng là sẽ vào được nhé.</b></p>
                    <p><b>Thời gian tới bị chặn căng hơn thì anh em vào Facebook hoặc Discord nhé, team DVC vẫn sẽ duy trì hoạt động song song trên các nền tảng bên dưới.</b></p>
                    <p><b>Cảm ơn anh em!</b></p>
                </div>
                <div class="modal-footer justify-content-center">
                    <a href="https://t.me/dvcipaios" class="btn btn-primary"><i class="bi bi-telegram"></i> Telegram</a>
                    <a href="https://www.facebook.com/groups/1062344111635711/?ref=share&mibextid=NSMWBT" class="btn btn-info text-white"><i class="bi bi-facebook"></i> Facebook</a>
                    <a href="https://dvcipa.github.io/discord.html" class="btn btn-secondary"><i class="bi bi-discord"></i> Discord</a>
                </div>
            </div>
        </div>
    </div>

    <main class="container my-4">
        <div class="row justify-content-center mb-4">
            <div class="col-lg-8">
                <div class="input-group">
                    <input type="text" id="searchInput" class="form-control" placeholder="Tìm game hack...">
                    <button class="btn btn-dark" type="button" onclick="searchPosts()"><i class="bi bi-search"></i> Tìm</button>
                </div>
            </div>
        </div>

        <div id="blogContainer" class="row g-3">
            </div>

        <div class="pagination-container mt-5" id="pagination">
            </div>
    </main>

    <footer class="footer bg-dark text-white text-center">
        <div class="container">
            <p class="mb-0">&copy; 2025 Team DVC. Xin cảm ơn anh em đã đồng hành và ủng hộ.</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const myModal = new bootstrap.Modal(document.getElementById('notificationModal'));
            myModal.show();
        });

        let allPosts = [];
        let currentPosts = [];

        async function loadBlogPosts() {
            try {
                const response = await fetch('post.txt');
                const text = await response.text();
                const files = text.match(/^\d+\.\s*(.+\.html)/gm).map(line => line.replace(/^\d+\.\s*/, ''));

                const postPromises = files.map(async (file) => {
                    try {
                        const res = await fetch(file);
                        if (!res.ok) return null;
                        const data = await res.text();
                        const doc = new DOMParser().parseFromString(data, 'text/html');
                        
                        const title = doc.querySelector('h1')?.innerText || 'Không có tiêu đề';
                        const img = doc.querySelector('div.container img')?.src || 'https://via.placeholder.com/100x100.png?text=DVC';

                        // THAY ĐỔI 2: Logic lấy nội dung chức năng thông minh hơn
                        let features = 'Không có mô tả chi tiết.';
                        // Lặp qua tất cả các thẻ trong trang con để tìm thẻ chứa chữ "Chức năng:"
                        const allElements = doc.body.querySelectorAll('*');
                        for (const el of allElements) {
                            if (el.textContent.includes("Chức năng:")) {
                                // Giả định rằng danh sách chức năng nằm ở thẻ ngay sau thẻ chứa tiêu đề "Chức năng:"
                                // Ví dụ: <p>Chức năng:</p> <ul>...</ul>
                                if (el.nextElementSibling) {
                                    features = el.nextElementSibling.innerHTML;
                                } 
                                // Hoặc nếu danh sách nằm ngay trong cùng một thẻ, sau một thẻ <br>
                                // Ví dụ: <p>Chức năng:<br>- Mod 1<br>- Mod 2</p>
                                else {
                                    let tempHTML = el.innerHTML;
                                    const keywordRegex = /Chức năng:(&nbsp;|<br>)?/i;
                                    const match = tempHTML.match(keywordRegex);
                                    if (match) {
                                        features = tempHTML.substring(match.index + match[0].length).trim();
                                    }
                                }
                                break; // Tìm thấy rồi thì dừng lại
                            }
                        }
                        
                        return { title, img, file, features };
                    } catch (error) {
                        console.error('Lỗi khi tải file:', file, error);
                        return null;
                    }
                });

                const posts = (await Promise.all(postPromises)).filter(p => p !== null);
                allPosts = posts.reverse();
                currentPosts = allPosts;
                displayPage(1);
            } catch (error) {
                console.error('Lỗi khi tải post.txt:', error);
                document.getElementById('blogContainer').innerHTML = `<div class="col-12"><div class="alert alert-danger">Không thể tải danh sách bài viết.</div></div>`;
            }
        }

        function displayPage(page) {
            const container = document.getElementById('blogContainer');
            //... (phần còn lại của hàm này không đổi)
            const paginationContainer = document.getElementById('pagination');
            const postsToDisplay = currentPosts;

            if (postsToDisplay.length === 0) {
                container.innerHTML = `<div class="col-12"><div class="alert alert-warning">Không tìm thấy kết quả nào.</div></div>`;
                paginationContainer.innerHTML = '';
                return;
            }

            const perPage = 10;
            const totalPages = Math.ceil(postsToDisplay.length / perPage);
            page = Math.max(1, Math.min(page, totalPages));

            const start = (page - 1) * perPage;
            const end = start + perPage;
            const paginatedPosts = postsToDisplay.slice(start, end);

            container.innerHTML = '';
            paginatedPosts.forEach(post => {
                const postCol = document.createElement('div');
                postCol.className = 'col-12';
                
                // THAY ĐỔI 3: Hiển thị nội dung HTML của features
                postCol.innerHTML = `
                    <div class="card post-card">
                        <div class="row g-0">
                            <div class="col-auto">
                                <img src="${post.img}" class="post-img rounded-start" alt="${post.title}">
                            </div>
                            <div class="col">
                                <div class="card-body py-2 px-3">
                                    <h5 class="card-title mb-1">${post.title}</h5>
                                    <div class="card-text text-muted small mb-2 features-text">
                                        <b>Chức năng:</b><br>
                                        ${post.features}
                                    </div>
                                    <a href="${post.file}" class="btn btn-sm btn-dark">Xem ngay...</a>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                container.appendChild(postCol);
            });

            renderPagination(page, totalPages);
        }

        function renderPagination(currentPage, totalPages) {
            const paginationContainer = document.getElementById('pagination');
            paginationContainer.innerHTML = '';
            if (totalPages <= 1) return;

            const paginationUl = document.createElement('ul');
            paginationUl.className = 'pagination';

            const createPageItem = (text, pageNum, isDisabled = false, isActive = false) => {
                const li = document.createElement('li');
                li.className = `page-item ${isDisabled ? 'disabled' : ''} ${isActive ? 'active' : ''}`;
                const a = document.createElement('a');
                a.className = 'page-link';
                a.href = '#';
                a.innerHTML = text;
                a.addEventListener('click', (e) => {
                    e.preventDefault();
                    if (!isDisabled) {
                        displayPage(pageNum);
                    }
                });
                li.appendChild(a);
                return li;
            };

            paginationUl.appendChild(createPageItem('&laquo;', currentPage - 1, currentPage === 1));

            let startPage = Math.max(1, currentPage - 2);
            let endPage = Math.min(totalPages, currentPage + 2);

            for (let i = startPage; i <= endPage; i++) {
                paginationUl.appendChild(createPageItem(i, i, false, i === currentPage));
            }
            
            paginationUl.appendChild(createPageItem('&raquo;', currentPage + 1, currentPage === totalPages));
            paginationContainer.appendChild(paginationUl);
        }

        function searchPosts() {
            const query = document.getElementById('searchInput').value.toLowerCase();
            currentPosts = allPosts.filter(post => post.title.toLowerCase().includes(query));
            displayPage(1);
        }

        loadBlogPosts();
    </script>
</body>
</html>
